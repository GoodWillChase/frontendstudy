<!DOCTYPE html>
<html>
<body>
<p id="demo">点击按钮获取您当前坐标（可能需要比较长的时间获取）：</p>
<button onclick="getLocation()">点我</button>
<script>
var x=document.getElementById("demo");

// 简单版
// var x=document.getElementById("demo");
// function getLocation()
//   {
//   if (navigator.geolocation)
//     {
//     navigator.geolocation.getCurrentPosition(showPosition);
//     }
//   else{x.innerHTML="该浏览器不支持获取地理位置。";}
//   }
// function showPosition(position)
//   {
//   x.innerHTML="纬度: " + position.coords.latitude + 
//   "<br>经度: " + position.coords.longitude;	
//   }


// 实例解析:
// 检测是否支持地理定位
// 如果支持，则运行 getCurrentPosition() 方法。如果不支持，则向用户显示一段消息。
// 如果getCurrentPosition()运行成功，则向参数showPosition中规定的函数返回一个coordinates对象
// showPosition() 函数获得并显示经度和纬度
function getLocation()
  {
  if (navigator.geolocation)
    {
    navigator.geolocation.getCurrentPosition(showPosition,showError);
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
function showPosition(position)
  {
  x.innerHTML="纬度: " + position.coords.latitude + 
  "<br>经度: " + position.coords.longitude;	
  }

// 处理错误和拒绝

// 错误代码：
// Permission denied - 用户不允许地理定位
// Position unavailable - 无法获取当前位置
// Timeout - 操作超时
function showError(error)
  {
  switch(error.code) 
    {
    case error.PERMISSION_DENIED:
      x.innerHTML="用户拒绝对获取地理位置的请求。"
      break;
    case error.POSITION_UNAVAILABLE:
      x.innerHTML="位置信息是不可用的。"
      break;
    case error.TIMEOUT:
      x.innerHTML="请求用户地理位置超时。"
      break;
    case error.UNKNOWN_ERROR:
      x.innerHTML="未知错误。"
      break;
    }
  }
</script>
</body>
</html>